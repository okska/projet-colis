import{r as W}from"./main--6Jdfoj8.js";var he=Object.defineProperty,pe=Object.defineProperties,ye=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertySymbols,ge=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable,K=(e,t,r)=>t in e?he(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,E=(e,t)=>{for(var r in t||(t={}))ge.call(t,r)&&K(e,r,t[r]);if(Z)for(var r of Z(t))me.call(t,r)&&K(e,r,t[r]);return e},w=(e,t)=>pe(e,ye(t)),ve=class extends Error{constructor(e,t,r){super(t||e.toString(),{cause:r}),this.status=e,this.statusText=t,this.error=r}},_e=async(e,t)=>{var r,n,s,i,o,f;let c=t||{};const a={onRequest:[t?.onRequest],onResponse:[t?.onResponse],onSuccess:[t?.onSuccess],onError:[t?.onError],onRetry:[t?.onRetry]};if(!t||!t?.plugins)return{url:e,options:c,hooks:a};for(const u of t?.plugins||[]){if(u.init){const d=await((r=u.init)==null?void 0:r.call(u,e.toString(),t));c=d.options||c,e=d.url}a.onRequest.push((n=u.hooks)==null?void 0:n.onRequest),a.onResponse.push((s=u.hooks)==null?void 0:s.onResponse),a.onSuccess.push((i=u.hooks)==null?void 0:i.onSuccess),a.onError.push((o=u.hooks)==null?void 0:o.onError),a.onRetry.push((f=u.hooks)==null?void 0:f.onRetry)}return{url:e,options:c,hooks:a}},ee=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},Re=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}};function Oe(e){if(typeof e=="number")return new ee({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new ee(e);case"exponential":return new Re(e);default:throw new Error("Invalid retry strategy")}}var Te=async e=>{const t={},r=async n=>typeof n=="function"?await n():n;if(e?.auth){if(e.auth.type==="Bearer"){const n=await r(e.auth.token);if(!n)return t;t.authorization=`Bearer ${n}`}else if(e.auth.type==="Basic"){const n=r(e.auth.username),s=r(e.auth.password);if(!n||!s)return t;t.authorization=`Basic ${btoa(`${n}:${s}`)}`}else if(e.auth.type==="Custom"){const n=r(e.auth.value);if(!n)return t;t.authorization=`${r(e.auth.prefix)} ${n}`}}return t},Ee=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function we(e){const t=e.headers.get("content-type"),r=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";const n=t.split(";").shift()||"";return Ee.test(n)?"json":r.has(n)||n.startsWith("text/")?"text":"blob"}function be(e){try{return JSON.parse(e),!0}catch{return!1}}function ie(e){if(e===void 0)return!1;const t=typeof e;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}function te(e){try{return JSON.parse(e)}catch{return e}}function re(e){return typeof e=="function"}function Se(e){if(e?.customFetchImpl)return e.customFetchImpl;if(typeof globalThis<"u"&&re(globalThis.fetch))return globalThis.fetch;if(typeof window<"u"&&re(window.fetch))return window.fetch;throw new Error("No fetch implementation found")}async function Pe(e){const t=new Headers(e?.headers),r=await Te(e);for(const[n,s]of Object.entries(r||{}))t.set(n,s);if(!t.has("content-type")){const n=Le(e?.body);n&&t.set("content-type",n)}return t}function Le(e){return ie(e)?"application/json":null}function Ae(e){if(!e?.body)return null;const t=new Headers(e?.headers);if(ie(e.body)&&!t.has("content-type")){for(const[r,n]of Object.entries(e?.body))n instanceof Date&&(e.body[r]=n.toISOString());return JSON.stringify(e.body)}return e.body}function xe(e,t){var r;if(t?.method)return t.method.toUpperCase();if(e.startsWith("@")){const n=(r=e.split("@")[1])==null?void 0:r.split("/")[0];return ue.includes(n)?n.toUpperCase():t?.body?"POST":"GET"}return t?.body?"POST":"GET"}function Ie(e,t){let r;return!e?.signal&&e?.timeout&&(r=setTimeout(()=>t?.abort(),e?.timeout)),{abortTimeout:r,clearTimeout:()=>{r&&clearTimeout(r)}}}var Ue=class ae extends Error{constructor(t,r){super(r||JSON.stringify(t,null,2)),this.issues=t,Object.setPrototypeOf(this,ae.prototype)}};async function V(e,t){let r=await e["~standard"].validate(t);if(r.issues)throw new Ue(r.issues);return r.value}var ue=["get","post","put","patch","delete"],Ce=e=>({id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(t,r){var n,s,i,o;const f=((s=(n=e.plugins)==null?void 0:n.find(c=>{var a;return(a=c.schema)!=null&&a.config?t.startsWith(c.schema.config.baseURL||"")||t.startsWith(c.schema.config.prefix||""):!1}))==null?void 0:s.schema)||e.schema;if(f){let c=t;(i=f.config)!=null&&i.prefix&&c.startsWith(f.config.prefix)&&(c=c.replace(f.config.prefix,""),f.config.baseURL&&(t=t.replace(f.config.prefix,f.config.baseURL))),(o=f.config)!=null&&o.baseURL&&c.startsWith(f.config.baseURL)&&(c=c.replace(f.config.baseURL,""));const a=f.schema[c];if(a){let u=w(E({},r),{method:a.method,output:a.output});return r?.disableValidation||(u=w(E({},u),{body:a.input?await V(a.input,r?.body):r?.body,params:a.params?await V(a.params,r?.params):r?.params,query:a.query?await V(a.query,r?.query):r?.query})),{url:t,options:u}}}return{url:t,options:r}}}),Ne=e=>{async function t(r,n){const s=w(E(E({},e),n),{plugins:[...e?.plugins||[],Ce(e||{})]});if(e?.catchAllError)try{return await Y(r,s)}catch(i){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:i}}}return await Y(r,s)}return t};function Me(e,t){let{baseURL:r,params:n,query:s}=t||{query:{},params:{},baseURL:""},i=e.startsWith("http")?e.split("/").slice(0,3).join("/"):r||"";if(e.startsWith("@")){const d=e.toString().split("@")[1].split("/")[0];ue.includes(d)&&(e=e.replace(`@${d}/`,"/"))}i.endsWith("/")||(i+="/");let[o,f]=e.replace(i,"").split("?");const c=new URLSearchParams(f);for(const[d,h]of Object.entries(s||{}))h!=null&&c.set(d,String(h));if(n)if(Array.isArray(n)){const d=o.split("/").filter(h=>h.startsWith(":"));for(const[h,P]of d.entries()){const L=n[h];o=o.replace(P,L)}}else for(const[d,h]of Object.entries(n))o=o.replace(`:${d}`,String(h));o=o.split("/").map(encodeURIComponent).join("/"),o.startsWith("/")&&(o=o.slice(1));let a=c.toString();return a=a.length>0?`?${a}`.replace(/\+/g,"%20"):"",i.startsWith("http")?new URL(`${o}${a}`,i):`${i}${o}${a}`}var Y=async(e,t)=>{var r,n,s,i,o,f,c,a;const{hooks:u,url:d,options:h}=await _e(e,t),P=Se(h),L=new AbortController,B=(r=h.signal)!=null?r:L.signal,v=Me(d,h),N=Ae(h),U=await Pe(h),A=xe(d,h);let l=w(E({},h),{url:v,headers:U,body:N,method:A,signal:B});for(const R of u.onRequest)if(R){const m=await R(l);m instanceof Object&&(l=m)}("pipeTo"in l&&typeof l.pipeTo=="function"||typeof((n=t?.body)==null?void 0:n.pipe)=="function")&&("duplex"in l||(l.duplex="half"));const{clearTimeout:M}=Ie(h,L);let p=await P(l.url,l);M();const Q={response:p,request:l};for(const R of u.onResponse)if(R){const m=await R(w(E({},Q),{response:(s=t?.hookOptions)!=null&&s.cloneResponse?p.clone():p}));m instanceof Response?p=m:m instanceof Object&&(p=m.response)}if(p.ok){if(!(l.method!=="HEAD"))return{data:"",error:null};const m=we(p),x={data:"",response:p,request:l};if(m==="json"||m==="text"){const I=await p.text(),de=await((i=l.jsonParser)!=null?i:te)(I);x.data=de}else x.data=await p[m]();l?.output&&l.output&&!l.disableValidation&&(x.data=await V(l.output,x.data));for(const I of u.onSuccess)I&&await I(w(E({},x),{response:(o=t?.hookOptions)!=null&&o.cloneResponse?p.clone():p}));return t?.throw?x.data:{data:x.data,error:null}}const le=(f=t?.jsonParser)!=null?f:te,q=await p.text(),z=be(q),H=z?await le(q):null,fe={response:p,responseText:q,request:l,error:w(E({},H),{status:p.status,statusText:p.statusText})};for(const R of u.onError)R&&await R(w(E({},fe),{response:(c=t?.hookOptions)!=null&&c.cloneResponse?p.clone():p}));if(t?.retry){const R=Oe(t.retry),m=(a=t.retryAttempt)!=null?a:0;if(await R.shouldAttemptRetry(m,p)){for(const I of u.onRetry)I&&await I(Q);const x=R.getDelay(m);return await new Promise(I=>setTimeout(I,x)),await Y(e,w(E({},t),{retryAttempt:m+1}))}}if(t?.throw)throw new ve(p.status,p.statusText,z?H:q);return{data:null,error:w(E({},H),{status:p.status,statusText:p.statusText})}},Be={},ne={};const G=Object.create(null),$=e=>Be||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?G:globalThis),O=new Proxy(G,{get(e,t){return $()[t]??G[t]},has(e,t){const r=$();return t in r||t in G},set(e,t,r){const n=$(!0);return n[t]=r,!0},deleteProperty(e,t){if(!t)return!1;const r=$(!0);return delete r[t],!0},ownKeys(){const e=$(!0);return Object.keys(e)}});function y(e,t){return typeof process<"u"&&ne?ne[e]??t:typeof Deno<"u"?Deno.env.get(e)??t:typeof Bun<"u"?Bun.env[e]??t:t}const j=1,g=4,b=8,_=24,se={eterm:g,cons25:g,console:g,cygwin:g,dtterm:g,gnome:g,hurd:g,jfbterm:g,konsole:g,kterm:g,mlterm:g,mosh:_,putty:g,st:g,"rxvt-unicode-24bit":_,terminator:_,"xterm-kitty":_},$e=new Map(Object.entries({APPVEYOR:b,BUILDKITE:b,CIRCLECI:_,DRONE:b,GITEA_ACTIONS:_,GITHUB_ACTIONS:_,GITLAB_CI:b,TRAVIS:b})),je=[/ansi/,/color/,/linux/,/direct/,/^con[0-9]*x[0-9]/,/^rxvt/,/^screen/,/^xterm/,/^vt100/,/^vt220/];function qe(){if(y("FORCE_COLOR")!==void 0)switch(y("FORCE_COLOR")){case"":case"1":case"true":return g;case"2":return b;case"3":return _;default:return j}if(y("NODE_DISABLE_COLORS")!==void 0&&y("NODE_DISABLE_COLORS")!==""||y("NO_COLOR")!==void 0&&y("NO_COLOR")!==""||y("TERM")==="dumb")return j;if(y("TMUX"))return _;if("TF_BUILD"in O&&"AGENT_NAME"in O)return g;if("CI"in O){for(const{0:e,1:t}of $e)if(e in O)return t;return y("CI_NAME")==="codeship"?b:j}if("TEAMCITY_VERSION"in O)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.exec(y("TEAMCITY_VERSION"))!==null?g:j;switch(y("TERM_PROGRAM")){case"iTerm.app":return!y("TERM_PROGRAM_VERSION")||/^[0-2]\./.exec(y("TERM_PROGRAM_VERSION"))!==null?b:_;case"HyperTerm":case"MacTerm":return _;case"Apple_Terminal":return b}if(y("COLORTERM")==="truecolor"||y("COLORTERM")==="24bit")return _;if(y("TERM")){if(/truecolor/.exec(y("TERM"))!==null)return _;if(/^xterm-256/.exec(y("TERM"))!==null)return b;const e=y("TERM").toLowerCase();if(se[e])return se[e];if(je.some(t=>t.exec(e)!==null))return g}return y("COLORTERM")?g:j}const S={reset:"\x1B[0m",bright:"\x1B[1m",dim:"\x1B[2m",fg:{red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m"}},X=["info","success","warn","error","debug"];function De(e,t){return X.indexOf(t)<=X.indexOf(e)}const ke={info:S.fg.blue,success:S.fg.green,warn:S.fg.yellow,error:S.fg.red,debug:S.fg.magenta},Fe=(e,t,r)=>{const n=new Date().toISOString();return r?`${S.dim}${n}${S.reset} ${ke[e]}${e.toUpperCase()}${S.reset} ${S.bright}[Better Auth]:${S.reset} ${t}`:`${n} ${e.toUpperCase()} [Better Auth]: ${t}`},Ve=e=>{const t="error",r=qe()!==1,n=(i,o,f=[])=>{if(!De(t,i))return;const c=Fe(i,o,r);{i==="error"?console.error(c,...f):i==="warn"?console.warn(c,...f):console.log(c,...f);return}};return{...Object.fromEntries(X.map(i=>[i,(...[o,...f])=>n(i,o,f)])),get level(){return t}}};Ve();class Ge extends Error{constructor(t,r){super(t),this.name="BetterAuthError",this.message=t,this.cause=r,this.stack=""}}function He(e){try{return(new URL(e).pathname.replace(/\/+$/,"")||"/")!=="/"}catch{throw new Ge(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}function J(e,t="/api/auth"){if(He(e))return e;const n=e.replace(/\/+$/,"");return!t||t==="/"?n:(t=t.startsWith("/")?t:`/${t}`,`${n}${t}`)}function We(e,t,r,n){if(e)return J(e,t);{const s=O.BETTER_AUTH_URL||O.NEXT_PUBLIC_BETTER_AUTH_URL||O.PUBLIC_BETTER_AUTH_URL||O.NUXT_PUBLIC_BETTER_AUTH_URL||O.NUXT_PUBLIC_AUTH_URL||(O.BASE_URL!=="/"?O.BASE_URL:void 0);if(s)return J(s,t)}if(typeof window<"u"&&window.location)return J(window.location.origin,t)}let T=[],C=0;const D=4;let ce=e=>{let t=[],r={get(){return r.lc||r.listen(()=>{})(),r.value},lc:0,listen(n){return r.lc=t.push(n),()=>{for(let i=C+D;i<T.length;)T[i]===n?T.splice(i,D):i+=D;let s=t.indexOf(n);~s&&(t.splice(s,1),--r.lc||r.off())}},notify(n,s){let i=!T.length;for(let o of t)T.push(o,r.value,n,s);if(i){for(C=0;C<T.length;C+=D)T[C](T[C+1],T[C+2],T[C+3]);T.length=0}},off(){},set(n){let s=r.value;s!==n&&(r.value=n,r.notify(s))},subscribe(n){let s=r.listen(n);return n(r.value),s},value:e};return r};const Je=5,k=6,F=10;let Ye=(e,t,r,n)=>(e.events=e.events||{},e.events[r+F]||(e.events[r+F]=n(s=>{e.events[r].reduceRight((i,o)=>(o(i),i),{shared:{},...s})})),e.events[r]=e.events[r]||[],e.events[r].push(t),()=>{let s=e.events[r],i=s.indexOf(t);s.splice(i,1),s.length||(delete e.events[r],e.events[r+F](),delete e.events[r+F])}),Xe=1e3,Qe=(e,t)=>Ye(e,n=>{let s=t(n);s&&e.events[k].push(s)},Je,n=>{let s=e.listen;e.listen=(...o)=>(!e.lc&&!e.active&&(e.active=!0,n()),s(...o));let i=e.off;return e.events[k]=[],e.off=()=>{i(),setTimeout(()=>{if(e.active&&!e.lc){e.active=!1;for(let o of e.events[k])o();e.events[k]=[]}},Xe)},()=>{e.listen=s,e.off=i}});function ze(e,t,r){let n=new Set(t).add(void 0);return e.listen((s,i,o)=>{n.has(o)&&r(s,i,o)})}const Ze=typeof window>"u",Ke=(e,t,r,n)=>{const s=ce({data:null,error:null,isPending:!0,isRefetching:!1,refetch:f=>i(f)}),i=f=>{const c=typeof n=="function"?n({data:s.get().data,error:s.get().error,isPending:s.get().isPending}):n;r(t,{...c,query:{...c?.query,...f?.query},async onSuccess(a){s.set({data:a.data,error:null,isPending:!1,isRefetching:!1,refetch:s.value.refetch}),await c?.onSuccess?.(a)},async onError(a){const{request:u}=a,d=typeof u.retry=="number"?u.retry:u.retry?.attempts,h=u.retryAttempt||0;d&&h<d||(s.set({error:a.error,data:null,isPending:!1,isRefetching:!1,refetch:s.value.refetch}),await c?.onError?.(a))},async onRequest(a){const u=s.get();s.set({isPending:u.data===null,data:u.data,error:null,isRefetching:!0,refetch:s.value.refetch}),await c?.onRequest?.(a)}}).catch(a=>{s.set({error:a,data:null,isPending:!1,isRefetching:!1,refetch:s.value.refetch})})};e=Array.isArray(e)?e:[e];let o=!1;for(const f of e)f.subscribe(()=>{Ze||(o?i():Qe(s,()=>{const c=setTimeout(()=>{o||(i(),o=!0)},0);return()=>{s.off(),f.off(),clearTimeout(c)}}))});return s},et={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},tt=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,oe={true:!0,false:!1,null:null,undefined:void 0,nan:Number.NaN,infinity:Number.POSITIVE_INFINITY,"-infinity":Number.NEGATIVE_INFINITY},rt=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/;function nt(e){return e instanceof Date&&!isNaN(e.getTime())}function st(e){const t=rt.exec(e);if(!t)return null;const[,r,n,s,i,o,f,c,a,u,d]=t;let h=new Date(Date.UTC(parseInt(r,10),parseInt(n,10)-1,parseInt(s,10),parseInt(i,10),parseInt(o,10),parseInt(f,10),c?parseInt(c.padEnd(3,"0"),10):0));if(a){const P=(parseInt(u,10)*60+parseInt(d,10))*(a==="+"?-1:1);h.setUTCMinutes(h.getUTCMinutes()+P)}return nt(h)?h:null}function ot(e,t={}){const{strict:r=!1,warnings:n=!1,reviver:s,parseDates:i=!0}=t;if(typeof e!="string")return e;const o=e.trim();if(o.length>0&&o[0]==='"'&&o.endsWith('"')&&!o.slice(1,-1).includes('"'))return o.slice(1,-1);const f=o.toLowerCase();if(f.length<=9&&f in oe)return oe[f];if(!tt.test(o)){if(r)throw new SyntaxError("[better-json] Invalid JSON");return e}if(Object.entries(et).some(([a,u])=>{const d=u.test(o);return d&&n&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${a} pattern`),d})&&r)throw new Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(o,(u,d)=>{if(u==="__proto__"||u==="constructor"&&d&&typeof d=="object"&&"prototype"in d){n&&console.warn(`[better-json] Dropping "${u}" key to prevent prototype pollution`);return}if(i&&typeof d=="string"){const h=st(d);if(h)return h}return s?s(u,d):d})}catch(a){if(r)throw a;return e}}function it(e,t={strict:!0}){return ot(e,t)}const at={id:"redirect",name:"Redirect",hooks:{onSuccess(e){if(e.data?.url&&e.data?.redirect&&typeof window<"u"&&window.location&&window.location)try{window.location.href=e.data.url}catch{}}}};function ut(e){const t=ce(!1);return{session:Ke(t,"/get-session",e,{method:"GET"}),$sessionSignal:t}}const ct=(e,t)=>{const r="credentials"in Request.prototype,n=We(e?.baseURL,e?.basePath)??"/api/auth",s=e?.plugins?.flatMap(l=>l.fetchPlugins).filter(l=>l!==void 0)||[],i={id:"lifecycle-hooks",name:"lifecycle-hooks",hooks:{onSuccess:e?.fetchOptions?.onSuccess,onError:e?.fetchOptions?.onError,onRequest:e?.fetchOptions?.onRequest,onResponse:e?.fetchOptions?.onResponse}},{onSuccess:o,onError:f,onRequest:c,onResponse:a,...u}=e?.fetchOptions||{},d=Ne({baseURL:n,...r?{credentials:"include"}:{},method:"GET",jsonParser(l){return l?it(l,{strict:!1}):null},customFetchImpl:fetch,...u,plugins:[i,...u.plugins||[],...e?.disableDefaultFetchPlugins?[]:[at],...s]}),{$sessionSignal:h,session:P}=ut(d),L=e?.plugins||[];let B={},v={$sessionSignal:h,session:P},N={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"};const U=[{signal:"$sessionSignal",matcher(l){return l==="/sign-out"||l==="/update-user"||l.startsWith("/sign-in")||l.startsWith("/sign-up")||l==="/delete-user"||l==="/verify-email"}}];for(const l of L)l.getAtoms&&Object.assign(v,l.getAtoms?.(d)),l.pathMethods&&Object.assign(N,l.pathMethods),l.atomListeners&&U.push(...l.atomListeners);const A={notify:l=>{v[l].set(!v[l].get())},listen:(l,M)=>{v[l].subscribe(M)},atoms:v};for(const l of L)l.getActions&&Object.assign(B,l.getActions?.(d,A,e));return{get baseURL(){return n},pluginsActions:B,pluginsAtoms:v,pluginPathMethods:N,atomListeners:U,$fetch:d,$store:A}};function lt(e){return typeof e=="object"&&e!==null&&"get"in e&&typeof e.get=="function"&&"lc"in e&&typeof e.lc=="number"}function ft(e,t,r){const n=t[e],{fetchOptions:s,query:i,...o}=r||{};return n||(s?.method?s.method:o&&Object.keys(o).length>0?"POST":"GET")}function dt(e,t,r,n,s){function i(o=[]){return new Proxy(function(){},{get(f,c){if(typeof c!="string"||c==="then"||c==="catch"||c==="finally")return;const a=[...o,c];let u=e;for(const d of a)if(u&&typeof u=="object"&&d in u)u=u[d];else{u=void 0;break}return typeof u=="function"||lt(u)?u:i(a)},apply:async(f,c,a)=>{const u="/"+o.map(U=>U.replace(/[A-Z]/g,A=>`-${A.toLowerCase()}`)).join("/"),d=a[0]||{},h=a[1]||{},{query:P,fetchOptions:L,...B}=d,v={...h,...L},N=ft(u,r,d);return await t(u,{...v,body:N==="GET"?void 0:{...B,...v?.body||{}},query:P||v?.query,method:N,async onSuccess(U){if(await v?.onSuccess?.(U),!s)return;const A=s.filter(l=>l.matcher(u));if(A.length)for(const l of A){const M=n[l.signal];if(!M)return;const p=M.get();setTimeout(()=>{M.set(!p)},10)}}})}})}return i()}function ht(e,t={}){let r=W.useRef(e.get());const{keys:n,deps:s=[e,n]}=t;let i=W.useCallback(f=>{const c=a=>{r.current!==a&&(r.current=a,f())};return c(e.value),n?.length?ze(e,n,c):e.listen(c)},s),o=()=>r.current;return W.useSyncExternalStore(i,o,o)}function pt(e){return`use${yt(e)}`}function yt(e){return e.charAt(0).toUpperCase()+e.slice(1)}function gt(e){const{pluginPathMethods:t,pluginsActions:r,pluginsAtoms:n,$fetch:s,$store:i,atomListeners:o}=ct(e);let f={};for(const[u,d]of Object.entries(n))f[pt(u)]=()=>ht(d);const c={...r,...f,$fetch:s,$store:i};return dt(c,s,t,n,o)}const mt="http://localhost:3000",Rt=gt({baseURL:mt});export{Rt as a};
