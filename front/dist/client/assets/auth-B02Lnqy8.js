import{r as c,j as e}from"./main--6Jdfoj8.js";import{a as j}from"./auth-client-D3uVBrLO.js";const p=j,f=n=>{if(!n)throw new Error("No response from auth server.");if(n.error){const{message:x,status:a,statusText:t}=n.error,u=a?`${a}${t?` ${t}`:""}`:t;throw new Error(x??(u?`Request failed (${u})`:"Request failed"))}};function P(){const n=j.useSession(),a=n.data?.user,[t,u]=c.useState(""),[o,S]=c.useState(""),[h,l]=c.useState(null),[b,d]=c.useState(null),[i,m]=c.useState(null),g=async s=>{if(!t||!o){d("Email and password are required.");return}m(s),d(null),l(null);try{const r=s==="sign-up"?await p.signUp.email({email:t,password:o}):await p.signIn.email({email:t,password:o});f(r),l(s==="sign-up"?"Account created. Check your inbox if verification is required, then sign in.":"Signed in successfully.")}catch(r){const w=r instanceof Error?r.message:"Something went wrong. Please try again.";d(w)}finally{m(null)}},N=async()=>{m("sign-out"),d(null),l(null);try{const s=await p.signOut();f(s),l("Signed out.")}catch(s){const r=s instanceof Error?s.message:"Unable to sign out right now.";d(r)}finally{m(null)}},y=!t||!o;return e.jsxs("div",{className:"space-y-4 p-4 max-w-md",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Better Auth"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Sign up or sign in with email. The API is served from your Hono backend at"," ",e.jsx("code",{children:"/api/auth/*"}),"."]})]}),e.jsxs("div",{className:"rounded border p-3",children:[e.jsx("p",{className:"font-medium",children:"Session"}),n.isPending?e.jsx("p",{children:"Loading session..."}):a?e.jsxs("div",{children:[e.jsxs("p",{className:"text-green-700",children:["Signed in as ",a.email]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["User ID: ",a.id]})]}):e.jsx("p",{className:"text-gray-600",children:"No active session."}),n.error&&e.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["Failed to fetch session: ",n.error.message]})]}),e.jsxs("form",{className:"space-y-2 rounded border p-3",onSubmit:s=>{s.preventDefault(),g("sign-in")},children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Email",e.jsx("input",{className:"mt-1 w-full rounded border px-2 py-1",type:"email",value:t,onChange:s=>u(s.target.value),required:!0})]}),e.jsxs("label",{className:"block text-sm font-medium",children:["Password",e.jsx("input",{className:"mt-1 w-full rounded border px-2 py-1",type:"password",value:o,onChange:s=>S(s.target.value),required:!0})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"rounded bg-blue-600 px-3 py-1 text-white disabled:opacity-60",disabled:y||i==="sign-in"||i==="sign-up",onClick:()=>{g("sign-in")},children:i==="sign-in"?"Signing In…":"Sign In"}),e.jsx("button",{type:"button",className:"rounded border border-blue-600 px-3 py-1 text-blue-600 disabled:opacity-60",disabled:y||i==="sign-in"||i==="sign-up",onClick:()=>{g("sign-up")},children:i==="sign-up"?"Signing Up…":"Sign Up"})]}),a&&e.jsx("button",{type:"button",className:"rounded border border-gray-600 px-3 py-1 text-gray-700 disabled:opacity-60",disabled:i==="sign-out",onClick:()=>{N()},children:i==="sign-out"?"Signing Out…":"Sign Out"}),h&&e.jsx("p",{className:"text-sm text-green-700",children:h}),b&&e.jsx("p",{className:"text-sm text-red-600",children:b})]})]})}export{P as component};
